{% extends 'base.html' %}
{% block content %}

    <h2>Cheapest Flights</h2>

<ul>
    <li> Airfare Options
        <br></br>

        <ul> 
                    {% if parsed_results_return is none %}
                        
                        {% for result in parsed_results %}
                    
                    <li> Departing on {{ result[0]['departure_date'] }} at {{ result[0]['departure_time'] }}</li>
                    <li> From {{ result[0]['airport_code_departure'] }}: {{ result[0]['airport_name_departure'] }}</li>
                    <li> Arriving on {{ result[0]['arrival_date'] }} at {{ result[0]['arrival_time'] }}</li>
                    <li> At {{ result[0]['airport_code_arrival'] }}: {{ result[0]['airport_name_arrival'] }}</li>

                    <li> Airlines : <a href="//{{ result[1] }} "> {{ result[0]['carrier_name'] }}</a></li>
                    <li> Aircraft Number:  {{ result[0]['carrier_code'] }} - {{ result[0]['aircraft_number'] }} </li>
                    <li> Flight duration: {{ result[0]['flight_duration'] }} minutes</li>

                    <h4>Price</h4>

                        {% set currency = result[0]['sale_fare_total'][:3] %}

                        <li> Airfare: {{ currency }} ${{ result[0]['sale_fare_total'][3:] }}</li>
                        <li> Tax: {{ currency }}  ${{ result[0]['sale_tax_total'][3:] }}</li>
                        <li> Total: {{ currency }}  ${{ result[0]['sale_total'][3:] }}</li>

                    <br></br>

                        {% endfor %}

                    {% else %}


                        <li> Departing on {{ parsed_results_return[0][0]['departure_date'] }} at {{ parsed_results_return[0][0]['departure_time'] }}</li>
                        <li> From {{ parsed_results_return[0][0]['airport_code_departure'] }}: {{ parsed_results_return[0][0]['airport_name_departure'] }}</li>
                        <li> Arriving on {{ parsed_results_return[0][0]['arrival_date'] }} at {{ parsed_results_return[0][0]['arrival_time'] }}</li>
                        <li> At {{ parsed_results_return[0][0]['airport_code_arrival'] }}: {{ parsed_results_return[0][0]['airport_name_arrival'] }}</li>

                        <li> Airlines : <a href="//{{ parsed_results_return[0][1][0] }} ">{{ parsed_results_return[0][0]['carrier_name'] }}</a> </li>
                        <li> Aircraft Number:{{ parsed_results_return[0][0]['carrier_code'] }} - {{ parsed_results_return[0][0]['aircraft_number'] }} </li>
                        <li> Flight duration: {{ parsed_results_return[0][0]['flight_duration'] }} minutes</li>
                        
                        <br></br>

                        <li> Returning on {{ parsed_results_return[1][0]['departure_date'] }} at {{ parsed_results_return[1][0]['departure_time'] }}</li>
                        <li> From {{ parsed_results_return[1][0]['airport_code_departure'] }}: {{ parsed_results_return[1][0]['airport_name_departure'] }}</li>
                        <li> Arriving on {{ parsed_results_return[1][0]['arrival_date'] }} at {{ parsed_results_return[1][0]['arrival_time'] }}</li>
                        <li> At {{ parsed_results_return[1][0]['airport_code_arrival'] }}: {{ parsed_results_return[1][0]['airport_name_arrival'] }}</li>

                        <li> Airlines : <a href="//{{ parsed_results_return[1][1][0] }} ">{{ parsed_results_return[1][0]['carrier_name'] }}</a>  {{ parsed_results_return[1][0]['carrier_code'] }} - {{ parsed_results_return[1][0]['aircraft_number'] }} </li>
                      
                        <li> Flight duration: {{ parsed_results_return[1][0]['flight_duration'] }} minutes</li>
                        <br></br>

                        <h4>Price</h4>
                        
                        {% set currency = parsed_results_return[0][0]['sale_fare_total'][:3] %}

                        <li> Airfare: {{ currency }}  ${{ parsed_results_return[0][0]['sale_fare_total'] | currencyadd(parsed_results_return[1][0]['sale_fare_total']) }}</li>
                        <li> Tax: {{ currency }}  ${{ parsed_results_return[0][0]['sale_tax_total'] | currencyadd(parsed_results_return[1][0]['sale_tax_total']) }}</li>
                        <li> Total: {{ currency }}  ${{ parsed_results_return[0][0]['sale_total'] | currencyadd(parsed_results_return[1][0]['sale_total']) }}</li>
                        <br></br>
                    

                    <br></br>

                {% endif %}

                
                
                <br></br>
        </ul>
    </li>        

</ul>

{% endblock %}
